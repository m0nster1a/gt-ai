<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GT-AI FiveM Server - Loot Cheat Sheet</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            color: #555;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #2a5298;
            border-bottom: 3px solid #2a5298;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-box {
            margin-bottom: 20px;
            padding: 12px 20px;
            width: 100%;
            max-width: 400px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1em;
            transition: border 0.3s;
        }

        .search-box:focus {
            outline: none;
            border-color: #2a5298;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        thead {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        tbody tr {
            transition: background 0.2s;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-common { background: #95a5a6; color: white; }
        .badge-uncommon { background: #27ae60; color: white; }
        .badge-rare { background: #3498db; color: white; }
        .badge-epic { background: #9b59b6; color: white; }
        .badge-legendary { background: #f39c12; color: white; }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #666;
        }

        .error {
            background: #fee;
            border: 1px solid #fcc;
            color: #c33;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .item-category {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ® GT-AI FiveM Server</h1>
            <p>Loot & Container Cheat Sheet</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="showTab('items')">Items</button>
            <button class="tab" onclick="showTab('containers')">Containers</button>
            <button class="tab" onclick="showTab('loot')">Loot Table</button>
        </div>

        <div class="content">
            <div id="items" class="tab-content active">
                <input type="text" class="search-box" id="searchItems" placeholder="ðŸ” Search items..." onkeyup="filterTable('itemsTable', 'searchItems')">
                <div id="itemsContent" class="loading">Loading items...</div>
            </div>

            <div id="containers" class="tab-content">
                <input type="text" class="search-box" id="searchContainers" placeholder="ðŸ” Search containers..." onkeyup="filterTable('containersTable', 'searchContainers')">
                <div id="containersContent" class="loading">Loading containers...</div>
            </div>

            <div id="loot" class="tab-content">
                <input type="text" class="search-box" id="searchLoot" placeholder="ðŸ” Search loot table..." onkeyup="filterTable('lootTable', 'searchLoot')">
                <div id="lootContent" class="loading">Loading loot table...</div>
            </div>
        </div>
    </div>

    <script>
        let excelData = {};
        let categories = {};

        // Load the Excel file
        async function loadExcelFile() {
            try {
                // Replace with your actual Excel file URL on GitHub
                const url = 'GTAI_LootSheet_Template.xlsx';
                const response = await fetch(url);
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });

                // Read all sheets
                workbook.SheetNames.forEach(sheetName => {
                    const worksheet = workbook.Sheets[sheetName];
                    excelData[sheetName] = XLSX.utils.sheet_to_json(worksheet);
                });

                // Load categories for color coding
                if (excelData['Categories Reference']) {
                    excelData['Categories Reference'].forEach(cat => {
                        categories[cat['Category Name']] = cat['Color Code (Hex)'];
                    });
                }

                displayItems();
                displayContainers();
                displayLootTable();
            } catch (error) {
                console.error('Error loading Excel file:', error);
                document.getElementById('itemsContent').innerHTML = 
                    '<div class="error">Failed to load data. Make sure the Excel file is in the same directory.</div>';
            }
        }

        function displayItems() {
            const items = excelData['Items'] || [];
            let html = '<table id="itemsTable"><thead><tr>';
            html += '<th>ID</th><th>Name</th><th>Category</th><th>Description</th><th>Rarity</th><th>Stack</th></tr></thead><tbody>';

            items.forEach(item => {
                const rarityClass = `badge-${(item.Rarity || 'common').toLowerCase()}`;
                const categoryColor = categories[item.Category] || '#A9A9A9';
                html += `<tr>
                    <td><strong>${item['Item ID']}</strong></td>
                    <td>${item['Item Name']}</td>
                    <td><span class="item-category" style="background: ${categoryColor}; color: white;">${item.Category}</span></td>
                    <td>${item.Description || ''}</td>
                    <td><span class="badge ${rarityClass}">${item.Rarity || 'Common'}</span></td>
                    <td>${item['Stack Size'] || 1}</td>
                </tr>`;
            });

            html += '</tbody></table>';
            document.getElementById('itemsContent').innerHTML = items.length ? html : '<div class="no-results">No items found</div>';
        }

        function displayContainers() {
            const containers = excelData['Containers'] || [];
            let html = '<table id="containersTable"><thead><tr>';
            html += '<th>ID</th><th>Name</th><th>Type</th><th>Location</th><th>Respawn Time</th></tr></thead><tbody>';

            containers.forEach(container => {
                html += `<tr>
                    <td><strong>${container['Container ID']}</strong></td>
                    <td>${container['Container Name']}</td>
                    <td>${container['Container Type']}</td>
                    <td>${container['Location/Map'] || 'Various'}</td>
                    <td>${container['Respawn Time'] || 'N/A'}</td>
                </tr>`;
            });

            html += '</tbody></table>';
            document.getElementById('containersContent').innerHTML = containers.length ? html : '<div class="no-results">No containers found</div>';
        }

        function displayLootTable() {
            const loot = excelData['Loot Table'] || [];
            const items = excelData['Items'] || [];
            const containers = excelData['Containers'] || [];

            // Create lookup maps
            const itemMap = {};
            items.forEach(item => {
                itemMap[item['Item ID']] = item['Item Name'];
            });

            const containerMap = {};
            containers.forEach(container => {
                containerMap[container['Container ID']] = container['Container Name'];
            });

            let html = '<table id="lootTable"><thead><tr>';
            html += '<th>Container</th><th>Item</th><th>Drop Chance</th><th>Quantity</th></tr></thead><tbody>';

            loot.forEach(entry => {
                const containerName = containerMap[entry['Container ID']] || entry['Container ID'];
                const itemName = itemMap[entry['Item ID']] || entry['Item ID'];
                const quantity = `${entry['Min Quantity']}-${entry['Max Quantity']}`;
                
                html += `<tr>
                    <td><strong>${containerName}</strong></td>
                    <td>${itemName}</td>
                    <td>${entry['Drop Chance (%)']}%</td>
                    <td>${quantity}</td>
                </tr>`;
            });

            html += '</tbody></table>';
            document.getElementById('lootContent').innerHTML = loot.length ? html : '<div class="no-results">No loot data found</div>';
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function filterTable(tableId, searchId) {
            const input = document.getElementById(searchId);
            const filter = input.value.toUpperCase();
            const table = document.getElementById(tableId);
            
            if (!table) return;
            
            const tr = table.getElementsByTagName('tr');

            for (let i = 1; i < tr.length; i++) {
                const row = tr[i];
                let found = false;
                const td = row.getElementsByTagName('td');
                
                for (let j = 0; j < td.length; j++) {
                    if (td[j]) {
                        const txtValue = td[j].textContent || td[j].innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            found = true;
                            break;
                        }
                    }
                }
                
                row.style.display = found ? '' : 'none';
            }
        }

        // Load data when page loads
        window.addEventListener('load', loadExcelFile);
    </script>
</body>
</html>
